
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>HpxHashTable &#8212; cygrid v1.0.2dev52</title>
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SlGrid" href="cygrid.SlGrid.html" />
    <link rel="prev" title="Healpix" href="cygrid.Healpix.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">cygrid</span><span id="logotext2"></span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="cygrid.SlGrid.html" title="SlGrid">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="cygrid.Healpix.html" title="Healpix">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">cygrid v1.0.2dev52</a>
	 &#187;
      </li>
      <li><a href="../user_manual.html" accesskey="U">Cygrid user manual</a> &#187;</li>
      
      <li>HpxHashTable</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hpxhashtable">
<h1>HpxHashTable<a class="headerlink" href="#hpxhashtable" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="cygrid.HpxHashTable">
<em class="property">class </em><code class="descclassname">cygrid.</code><code class="descname">HpxHashTable</code><span class="sig-paren">(</span><em>uint64_t nside=1</em>, <em>uint32_t scheme=RING</em>, <em>bool dbg_messages=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cygrid.Healpix.html#cygrid.Healpix" title="cygrid.healpix.Healpix"><code class="docutils literal notranslate"><span class="pre">cygrid.Healpix</span></code></a></p>
<p>Helper class for creating cygrid’s lookup tables (HEALPix).</p>
<p>This is used to speed-up cygrid, there is not really any other
meaningful application of this class. <a class="reference internal" href="#cygrid.HpxHashTable" title="cygrid.HpxHashTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HpxHashTable</span></code></a> derives from the
<a class="reference internal" href="cygrid.Healpix.html#cygrid.Healpix" title="cygrid.Healpix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Healpix</span></code></a> class and adds-in a few helper functions and lookup-table
members.</p>
<p>Usually, only two methods have to be called: <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_helpers</span></code> (once)
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_output_pixels</span></code> (for each <a class="reference internal" href="cygrid.Cygrid.html#cygrid.Cygrid.grid" title="cygrid.Cygrid.grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid</span></code></a> call)
See the documentation of the methods for more information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>nside</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a> parameter.</p>
</dd>
<dt><strong>scheme</strong> <span class="classifier-delimiter">:</span> <span class="classifier">enum</span></dt>
<dd><p class="first last">The HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.scheme" title="cygrid.HpxHashTable.scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scheme</span></code></a>. Currently, only ‘RING’ is supported.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p class="first">The class holds a dictionary (<code class="xref py py-obj docutils literal notranslate"><span class="pre">target_dict</span></code>) that contains for each
HEALPix index the list of pixel (centers) of the target (WCS) map that
fall into this HEALPix index. For sanity a vector for the pixel centers
is used, in case multiple pixels from the WCS map have the same HPX
index. Since we need to invert the dictionary later, the coordinate
pixel pair is mapped to an integer using the very simple
transformation:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">xy_hash</span> <span class="o">=</span> <span class="n">xpix</span> <span class="o">*</span> <span class="n">MAX_Y</span> <span class="o">+</span> <span class="n">ypix</span>  <span class="c1"># with MAX_Y == 2**30</span>
</pre></div>
</div>
</li>
<li><p class="first">All operations make use of the ‘RING’ scheme indexing. Therefore, we
store the HEALPix index of the first pixel in each ring, the number of
HEALPix pixels per ring and the index of the
<span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> pixel (or rather the closest pixel to the
left of <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span>, if ring is shifted).</p>
</li>
<li><p class="first">Furthermore, we store for each ring the HEALPix indices of a disc (with
specified radius) as valid for <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span>. These
indices can easily be shifted along the <span class="math notranslate nohighlight">\(\varphi\)</span> coordinate to
quickly construct discs at any position.</p>
</li>
<li><p class="first">For all of the above, only those indices/rings are stored that are
going to be used. Of course, if disc radius (aka kernel support
radius) is changed, the caches need to be recomputed.</p>
</li>
</ol>
<p class="rubric">Attributes Summary</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.ncap" title="cygrid.HpxHashTable.ncap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ncap</span></code></a></td>
<td>property ncap : unsigned 64-bit int</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.npface" title="cygrid.HpxHashTable.npface"><code class="xref py py-obj docutils literal notranslate"><span class="pre">npface</span></code></a></td>
<td>property nface : unsigned 64-bit int</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.npix" title="cygrid.HpxHashTable.npix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">npix</span></code></a></td>
<td>property npix : unsigned 64-bit int</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.nrings" title="cygrid.HpxHashTable.nrings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nrings</span></code></a></td>
<td>property nrings : unsigned 64-bit int</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a></td>
<td>property nside : unsigned 64-bit int</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.omega" title="cygrid.HpxHashTable.omega"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omega</span></code></a></td>
<td>property omega : double</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.order" title="cygrid.HpxHashTable.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a></td>
<td>property order : unsigned 64-bit int</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.resolution" title="cygrid.HpxHashTable.resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resolution</span></code></a></td>
<td>property resolution : double</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.scheme" title="cygrid.HpxHashTable.scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scheme</span></code></a></td>
<td>property scheme : enum</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.ang2pix" title="cygrid.HpxHashTable.ang2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ang2pix</span></code></a>(self,&nbsp;double&nbsp;theta,&nbsp;double&nbsp;phi)</td>
<td>Return the pixel index containing the angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.ang2pix_many" title="cygrid.HpxHashTable.ang2pix_many"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ang2pix_many</span></code></a>(self,&nbsp;double[,&nbsp;double[)</td>
<td>Return the pixel indices containing the angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.clear_hashes" title="cygrid.HpxHashTable.clear_hashes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_hashes</span></code></a>(self)</td>
<td>Clear all internal caches/dictionaries.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.get_ring_info_small" title="cygrid.HpxHashTable.get_ring_info_small"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ring_info_small</span></code></a>(self,&nbsp;uint64_t&nbsp;ring)</td>
<td>Return start index and number of pixels per healpix ring.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.pix2ang" title="cygrid.HpxHashTable.pix2ang"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ang</span></code></a>(self,&nbsp;uint64_t&nbsp;pix)</td>
<td>Convert HEALPix index to angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.pix2ang_many" title="cygrid.HpxHashTable.pix2ang_many"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ang_many</span></code></a>(self,&nbsp;long[)</td>
<td>Convert HEALPix indices to angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.pix2ring" title="cygrid.HpxHashTable.pix2ring"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ring</span></code></a>(self,&nbsp;uint64_t&nbsp;pix)</td>
<td>Return ‘ring’ number that contains the HEALPix pixel, ‘pix’.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.pix2ring_many" title="cygrid.HpxHashTable.pix2ring_many"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ring_many</span></code></a>(self,&nbsp;long[)</td>
<td>Return ‘ring’ numbers containing HEALPix pixels given in array, ‘pix’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.query_disc" title="cygrid.HpxHashTable.query_disc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc</span></code></a>(self,&nbsp;double&nbsp;theta,&nbsp;double&nbsp;phi,&nbsp;…)</td>
<td>Return hpx indices of a disc around <span class="math notranslate nohighlight">\((\vartheta, \varphi)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cygrid.HpxHashTable.query_disc_phi180" title="cygrid.HpxHashTable.query_disc_phi180"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc_phi180</span></code></a>(self,&nbsp;…)</td>
<td>Return HEALPix indices of a disc around <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> for ‘disc_ring’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cygrid.HpxHashTable.set_optimal_nside" title="cygrid.HpxHashTable.set_optimal_nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_optimal_nside</span></code></a>(self,&nbsp;double&nbsp;target_res)</td>
<td>Set the HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a> such that HEALPix resolution is less than <code class="xref py py-obj docutils literal notranslate"><span class="pre">target_res</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="attribute">
<dt id="cygrid.HpxHashTable.ncap">
<code class="descname">ncap</code><a class="headerlink" href="#cygrid.HpxHashTable.ncap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property ncap <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd>Return the HEALPix ‘ncap’ parameter.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.npface">
<code class="descname">npface</code><a class="headerlink" href="#cygrid.HpxHashTable.npface" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property nface <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd>Return the HEALPix ‘nface’ parameter.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.npix">
<code class="descname">npix</code><a class="headerlink" href="#cygrid.HpxHashTable.npix" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property npix <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd>Return the HEALPix ‘npix’ parameter.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.nrings">
<code class="descname">nrings</code><a class="headerlink" href="#cygrid.HpxHashTable.nrings" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property nrings <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd>Return the HEALPix ‘nrings’ parameter.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.nside">
<code class="descname">nside</code><a class="headerlink" href="#cygrid.HpxHashTable.nside" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property nside <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd>The HEALPix ‘nside’ parameter. (Re-)setting ‘nside’ updates other
properties.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.omega">
<code class="descname">omega</code><a class="headerlink" href="#cygrid.HpxHashTable.omega" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property omega <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd>Return the solid angle, ‘omega’ of the HEALPix pixels
for current <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a>.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.order">
<code class="descname">order</code><a class="headerlink" href="#cygrid.HpxHashTable.order" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property order <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd>Return the HEALPix ‘order’ parameter.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.resolution">
<code class="descname">resolution</code><a class="headerlink" href="#cygrid.HpxHashTable.resolution" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property resolution <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd>Return the angular size of the HEALPix pixels for current <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a>.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="cygrid.HpxHashTable.scheme">
<code class="descname">scheme</code><a class="headerlink" href="#cygrid.HpxHashTable.scheme" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>property scheme <span class="classifier-delimiter">:</span> <span class="classifier">enum</span></dt>
<dd>The HEALPix ‘scheme’. Currently only ‘RING’ is supported.</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="method">
<dt id="cygrid.HpxHashTable.ang2pix">
<code class="descname">ang2pix</code><span class="sig-paren">(</span><em>self</em>, <em>double theta</em>, <em>double phi</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.ang2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pixel index containing the angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</p>
<p>Wrapper around the Cython-only (private) method _ang2pix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix pixel index.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last">Invalid theta value.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.ang2pix_many">
<code class="descname">ang2pix_many</code><span class="sig-paren">(</span><em>self</em>, <em>double[::1] theta</em>, <em>double[::1] phi</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.ang2pix_many" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pixel indices containing the angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</p>
<p>Wrapper around the Cython-only (private) method _ang2pix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of doubles</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of doubles</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pix</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of unsigned 64-bit ints</span></dt>
<dd><p class="first last">The HEALPix pixel index.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.clear_hashes">
<code class="descname">clear_hashes</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.clear_hashes" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all internal caches/dictionaries.</p>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.get_ring_info_small">
<code class="descname">get_ring_info_small</code><span class="sig-paren">(</span><em>self</em>, <em>uint64_t ring</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.get_ring_info_small" title="Permalink to this definition">¶</a></dt>
<dd><p>Return start index and number of pixels per healpix ring.</p>
<p>Wrapper around the Cython-only (private) method
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_get_ring_info_small</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ring</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix ring parameter to get information on.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>startpix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix index of the first pixel in ring.</p>
</dd>
<dt><strong>num_pix_in_ring</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The number of HEALPix pixels in ring.</p>
</dd>
<dt><strong>shifted</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether the central HEALPix pixel in that ring is shifted from
<span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last">Ring index not in valid range.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.pix2ang">
<code class="descname">pix2ang</code><span class="sig-paren">(</span><em>self</em>, <em>uint64_t pix</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ang" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert HEALPix index to angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</p>
<p>Wrapper around the Cython-only (private) method <code class="xref py py-obj docutils literal notranslate"><span class="pre">_pix2ang</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix pixel index.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix</span></code> not in valid range.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.pix2ang_many">
<code class="descname">pix2ang_many</code><span class="sig-paren">(</span><em>self</em>, <em>long[::1] pix</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ang_many" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert HEALPix indices to angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</p>
<p>Wrapper around the Cython-only (private) method <code class="xref py py-obj docutils literal notranslate"><span class="pre">_pix2ang</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pix</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of unsigned 64-bit ints</span></dt>
<dd><p class="first last">The HEALPix pixel index.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of doubles</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of doubles</span></dt>
<dd><p class="first last"><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.pix2ring">
<code class="descname">pix2ring</code><span class="sig-paren">(</span><em>self</em>, <em>uint64_t pix</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ‘ring’ number that contains the HEALPix pixel, ‘pix’.</p>
<p>Wrapper around the Cython-only (private) method _pix2ring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix index.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ring</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">The HEALPix ring.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last">Pixel index not in valid range.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.pix2ring_many">
<code class="descname">pix2ring_many</code><span class="sig-paren">(</span><em>self</em>, <em>long[::1] pix</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ring_many" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ‘ring’ numbers containing HEALPix pixels given in array, ‘pix’.</p>
<p>Wrapper around the Cython-only (private) method _pix2ring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pix</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of unsigned 64-bit ints</span></dt>
<dd><p class="first last">The HEALPix indices.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ring</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of unsigned 64-bit ints</span></dt>
<dd><p class="first last">The HEALPix rings.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.query_disc">
<code class="descname">query_disc</code><span class="sig-paren">(</span><em>self</em>, <em>double theta</em>, <em>double phi</em>, <em>double disc_size_rad</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.query_disc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return hpx indices of a disc around <span class="math notranslate nohighlight">\((\vartheta, \varphi)\)</span>.</p>
<p>This uses <a class="reference internal" href="#cygrid.HpxHashTable.query_disc_phi180" title="cygrid.HpxHashTable.query_disc_phi180"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc_phi180</span></code></a> and shifts the pixels along ring.</p>
<p>Wrapper around the cython-only (private) method _query_disc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta/phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last">Coordinates <span class="math notranslate nohighlight">\((\vartheta, \varphi)\)</span> in radians.</p>
</dd>
<dt><strong>disc_size_rad</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last">Size of the disc in radians.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>disc_indices</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of unsigned 64-bit ints</span></dt>
<dd><p class="first last">The HEALPix indices of the disc.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.query_disc_phi180">
<code class="descname">query_disc_phi180</code><span class="sig-paren">(</span><em>self</em>, <em>double disc_size_rad</em>, <em>uint64_t disc_ring</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.query_disc_phi180" title="Permalink to this definition">¶</a></dt>
<dd><p>Return HEALPix indices of a disc around <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> for ‘disc_ring’.</p>
<p>This is a modified version of the HEALPix library <code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc</span></code>
routine that returns the HEALPix indices of a disc around arbitrary
coordinates. Here, it was modified to only work for coordinates having
<span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> and a <span class="math notranslate nohighlight">\(\vartheta\)</span> that coincides
with the latitude of a HEALPix ring. These discs can be shifted along
<span class="math notranslate nohighlight">\(\varphi\)</span> - which is faster than calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc</span></code>
if one cashes the <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> discs.</p>
<p>Wrapper around the Cython-only (private) method <code class="xref py py-obj docutils literal notranslate"><span class="pre">_query_disc_phi180</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>disc_size_rad</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last">Size of the disc in radians.</p>
</dd>
<dt><strong>disc_ring</strong> <span class="classifier-delimiter">:</span> <span class="classifier">unsigned 64-bit int</span></dt>
<dd><p class="first last">HEALPix ring index of the requested disc center.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>disc_indices</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.15)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of unsigned 64-bit ints</span></dt>
<dd><p class="first last">The HEALPix indices of the disc.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cygrid.HpxHashTable.set_optimal_nside">
<code class="descname">set_optimal_nside</code><span class="sig-paren">(</span><em>self</em>, <em>double target_res</em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.set_optimal_nside" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a> such that HEALPix resolution is less than <code class="xref py py-obj docutils literal notranslate"><span class="pre">target_res</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>target_res</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double</span></dt>
<dd><p class="first last">Requested target resolution of the HEALPix representation. <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a>
will be set such that the HEALPix resolution is better than
<code class="xref py py-obj docutils literal notranslate"><span class="pre">target_res</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">HpxHashTable</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/bwinkel/cygrid/tree/master/docs/api/cygrid.HpxHashTable.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/api/cygrid.HpxHashTable.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2019, Benjamin Winkel, Lars Flöer, Daniel Lenz.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.3. &nbsp;
    Last built 01 Feb 2019. <br/>
  </p>
</footer>
  </body>
</html>